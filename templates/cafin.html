<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="description" content="" />
    <meta name="author" content="" />

    <title>Cifrado afín</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700&family=Open+Sans&display=swap"
      rel="stylesheet"
    />
    <link href="../static/css/bootstrap.min.css" rel="stylesheet" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.0/font/bootstrap-icons.min.css"
      rel="stylesheet"
    />
    <link href="../static/css/templatemo-topic-listing.css" rel="stylesheet" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.0/font/bootstrap-icons.min.css"
      rel="stylesheet"
    />

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>

  <body id="top">
    <main>
      <nav class="navbar navbar-expand-lg">
        <div class="container">
          <a class="navbar-brand" href="{{ url_for('index') }}">
            <i class="bi bi-person-lock"></i>
            <span>CryptoPlayground</span>
          </a>

          <div class="d-lg-none ms-auto me-4">
            <a href="#top" class="navbar-icon bi-person smoothscroll"></a>
          </div>

          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarNav"
            aria-controls="navbarNav"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>

          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-lg-5 me-lg-auto">
              <li class="nav-item">
                <a class="nav-link click-scroll" href="/">Inicio</a
                >
              </li>

              <li class="nav-item">
                <a class="nav-link click-scroll" href="/"
                  >Explorar cifrados</a
                >
              </li>

              <li class="nav-item">
                <a class="nav-link click-scroll" href="/ #section_3"
                  >Cómo funciona</a
                >
              </li>

              <li class="nav-item">
                <a class="nav-link click-scroll" href="{{ url_for('contact') }}">Nosotros</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>

        <header
          class="site-header d-flex flex-column justify-content-center align-items-center"
        >
          <div class="container">
            <div class="row justify-content-center align-items-center">
              <div class="col-lg-5 col-12 mb-5">
                <nav aria-label="breadcrumb">
                  <ol class="breadcrumb">
                    <li class="breadcrumb-item">
                      <a href="{{ url_for('index') }}">Inicio</a>

                    <li class="breadcrumb-item active" aria-current="page">
                      Cifrado 1
                    </li>
                  </ol>
                </nav>

                <h2 class="text-white">Cifrado afin<br /></h2>

                <div class="d-flex align-items-center mt-5">
                  <a
                    href="#playground"
                    class="btn custom-btn custom-border-btn smoothscroll me-4"
                    >Playground!</a
                  >
                </div>
              </div>

              <div class="col-lg-5 col-12">
                <div class="topics-detail-block bg-white shadow-lg">
                  <img
                    src="../static/images/topics/undraw_Remote_design_team_re_urdx.png"
                    class="topics-detail-block-image img-fluid"
                  />
                </div>
              </div>
            </div>
          </div>
        </header>

        <section class="section-padding section-bg" id="playground">
          <div class="container">
              <div class="row justify-content-center text-center">
                  <div class="col-lg-12 col-12">
                      <h3 class="mb-4 pb-2">Cifrado afín</h3>
                  </div>
                  <div class="col-lg-6 col-12">
                    <form id="cipherForm" class="custom-form contact-form">
                      <div class="row gy-4 justify-content-center">
                          <div class="col-lg-12 col-12">
                              <div class="btn-group" role="group">
                                  <input type="radio" class="btn-check" name="action" id="encryptRadio" value="encrypt" checked>
                                  <label class="btn btn-outline-primary rounded-pill px-4 mx-2 custom-radio-btn" for="encryptRadio">Encriptar</label>
                  
                                  <input type="radio" class="btn-check" name="action" id="decryptRadio" value="decrypt">
                                  <label class="btn btn-outline-primary rounded-pill px-4 mx-2 custom-radio-btn" for="decryptRadio">Desencriptar</label>
                              </div>
                          </div>
                  
                          <div class="col-lg-12 col-12">
                              <div class="form-floating">
                                  <textarea class="form-control" id="message" placeholder="Escribe aquí..." required></textarea>
                                  <label for="message">Texto cifrar</label>
                              </div>
                          </div>
                  
                          <div class="row">
                            <div class="col-lg-6 col-12">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="key1" placeholder="Ej: 231" required>
                                    <label for="key1">Clave a (ej: 3)</label>
                                </div>
                            </div>
                            <div class="col-lg-6 col-12">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="key2" placeholder="Ej: 231" required>
                                    <label for="key2">Clave b (ej: 10)</label>
                                </div>
                            </div>
                          </div>
                  
                          <div class="col-lg-4 col-12">
                              <button id="procesarBtn" type="submit" class="form-control btn btn-primary">Procesar</button>
                          </div>
                        </div>
                      </form>
                      <div id="resultado" class="mt-4 p-3 bg-light" style="border-radius: 35px;">
                          <h5>Texto cifrado:</h5>
                          <p id="resultText" class="fw-bold text-primary"></p>
                      </div>
                  </div>
              </div>
          </div>
      </section>
      
      
      <div class="row gy-4 justify-content-center">
        {% if texto_cifrado %}
        <div class="col-lg-12 col-12">
          <div class="alert alert-success">
            <strong>Mensaje cifrado:</strong> {{ texto_cifrado }}
          </div>
        </div>
        {% endif %}
      </div>

      <section class="topics-detail-section section-padding" id="biblio">
        <div class="container">
          <div class="row">
            <div class="col-lg-8 col-12 m-auto">
              <h3 class="mb-4">Cifrado afín</h3>

              <p>
                El cifrado afín es un método de sustitución monoalfabética en el que cada letra del mensaje original es reemplazada por otra según una función matemática. 
                Es una mejora del cifrado César, ya que introduce un segundo parámetro de cifrado y evita algunas de sus debilidades.<br>
                EL caso de este cifrado  es particular pues a sido usado desde la antigüedad. Se basa en conceptos matemáticos más avanzados que los 
                utilizados en el cifrado César, que simplemente desplazaba las letras un número fijo de posiciones. Aunque no se conoce una fecha exacta de su invención, 
                los principios en los que se basa han sido utilizados desde la época de la criptografía clásica.
              </p>

              <p>
                <strong>¿Cómo funciona?</strong><br>
                El cifrado afín usa una función matemática para transformar cada letra del mensaje original en otra del alfabeto. La fórmula utilizada es:<br>
                <div class="equation-container">
                    <p>
                        $$ C = (aP + b) \mod m $$
                    </p>
                </div>
              </p>
              <p>
                Donde: <br>
              </p>
                <ul>
                    <li><em>P</em> es la posición de la letra en el alfabeto (comenzando desde 0).</li>
                    <li><em>C</em> es la nueva posición cifrada de la letra.</li>
                    <li><em>a</em> y <em>b</em> son las claves del cifrado.</li>
                    <li><em>m</em> es el tamaño del alfabeto (por ejemplo, 26 para el inglés).</li>
                    <li><em>a</em> debe ser un número tal que tenga inverso modular con respecto a <em>m</em> (es decir, <em>gcd(a,m)= 1 </em>), lo que garantiza 
                        que el cifrado sea reversible.</li>
                </ul>
              </p>

              <p>
                <strong>Veamos un ejemplo.</strong>
                <ol>
                    <li><p>Convetimos cada letra en un número</p></li>
                    <ul>
                        <li>A=0, B=1, C=2, ..., Z=25</li>
                        <li>Por ejemplo, la palabra HOLA la convertimos en 7, 14, 11, 0</li>
                    </ul>
                    <li><p>Aplicamos la función matemática</p></li>
                    <ul>
                        <li>Supongamos que elegimos como claves <em>a=5</em> y <em>b=8</em>, con <em>m=26</em>.</li>
                        <li>Aplicamos la formúla para cada letra:</li>
                        <div class="equation-container">
                            $$ C=(5P + 8) \mod 26 $$
                        </div>
                        <p>Para la letra H (7) tenemos:</p>
                        <div class="equation-container">
                            $$ C=(5*7 + 8) \mod 26 = 43 \mod 26 = 17 $$
                        </div>
                        <p>Para la letra O (14) tenemos:</p>
                        <div class="equation-container">
                            $$ C=(5*14 + 8) \mod 26 = 78 \mod 26 = 0 $$
                        </div>
                        <p>Para la letra L (11) tenemos:</p>
                        <div class="equation-container">
                            $$ C=(5*11 + 8) \mod 26 = 63 \mod 26 = 11 $$
                        </div>
                        <p>Para la letra A (0) tenemos:</p>
                        <div class="equation-container">
                            $$ C=(5*0 + 8) \mod 26 = 8 \mod 26 = 8 $$
                        </div>
                        <p>Como resultado obtenermos 17 0 11 8 que si lo pasamos a las letras correspondientes obtenemos <strong>RALI</strong></p>
                    </ul>
                </ol>  
              </p>

              <p>
                <strong>¿Cómo desencriptamos?</strong>
                <p>Si queremos recuperar el mensaje original, vamos a usar la ecuación inversa:</p>
                    <div class="equation-container">
                        $$ P = a^{-1}(C - b) \mod m $$
                    </div>
                <p>Sin embargo quemos que encontrar el inverso modular de <em>a</em> y <em>m</em> teniendo en cuenta que:</p>
                    <div class="equation-container">
                        $$ a \cdot a^{-1} \equiv 1 \mod m $$
                    </div>
                <p>Para nuestro ejemplo, donde <em>a=5</em> y <em>m=26</em> tenemos que:</p>
                    <div class="equation-container">
                        $$ 5 \cdot 21 \equiv 1 \mod 26 $$
                    </div>
                <p>Por lo tanto encontramos que el inverso es 21. Por ende solo es necesario aplicar la ecuación inversa.</p>
                    <ul>
                        <p>Para R (C=17):</p>
                        <div class = "equation-container">
                            $$ P = 21(17 - 8) \mod 26 = 21(9) \mod 26 = 189 \mod 26 = 7 $$
                        </div>
                        <p>Para A (C=0):</p>
                        <div class = "equation-container">
                            $$ P = 21(0 - 8) \mod 26 = 21(-8) \mod 26 = 168 \mod 26 = 14 $$
                        </div>
                        <p>Para L (C=11):</p>
                        <div class = "equation container">
                            $$ P = 21(11 - 8) \mod 26 = 21(3) \mod 26 = 63 \mod 26 = 11 $$
                        </div>
                        <p>Para I (C=8):</p>
                        <div class = "equation-container">
                            $$ P = 21(8 - 8) \mod 26 = 21(0) \mod 26 = 0 $$
                        </div>
                    </ul>
                </ol>  
              </p>
            </div>
          </div>
        </div>
      </section>
    </main>

    <script src="../static/js/jquery.min.js"></script>
    <script src="../static/js/bootstrap.bundle.min.js"></script>
    <script src="../static/js/jquery.sticky.js"></script>
    <script src="../static/js/custom.js"></script>
  </body>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
        document.getElementById("cipherForm").addEventListener("submit", async (e) => {
            e.preventDefault();
            
            const message = document.getElementById("message").value;
            const key1 = document.getElementById("key1").value;
            const key2 = document.getElementById("key2").value;
            const action = document.querySelector('input[name="action"]:checked').value;
            const resultElement = document.getElementById("resultText");

            try {
                const response = await fetch("/process-affine", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 
                        message: message,
                        key1: key1,
                        key2: key2,
                        action: action
                    })
                });

                const data = await response.json();
                
                if (!response.ok) throw new Error(data.error || "Error del servidor");
                
                resultElement.textContent = data.result;
                resultElement.classList.remove("text-danger");
                resultElement.classList.add("text-primary");
            } catch (error) {
                resultElement.textContent = `Error: ${error.message}`;
                resultElement.classList.remove("text-primary");
                resultElement.classList.add("text-danger");
                console.error("Error:", error);
            }
        });
    });

    document.addEventListener("DOMContentLoaded", function () {
        const resultadoDiv = document.getElementById("resultado");
        const procesarBtn = document.getElementById("procesarBtn");

        // Ocultar el div al cargar la página
        resultadoDiv.style.display = "none";

        procesarBtn.addEventListener("click", function () {
            // Aquí podrías agregar la lógica para enviar los datos al backend
            // Por ahora, solo mostramos el div de resultado
            resultadoDiv.style.display = "block";
        });
    });
</script>

</html>

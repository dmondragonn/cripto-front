<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="description" content="" />
    <meta name="author" content="" />

    <title>Cifrado RSA</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700&family=Open+Sans&display=swap"
      rel="stylesheet"
    />
    <link href="../static/css/bootstrap.min.css" rel="stylesheet" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.0/font/bootstrap-icons.min.css"
      rel="stylesheet"
    />
    <link href="../static/css/templatemo-topic-listing.css" rel="stylesheet" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.0/font/bootstrap-icons.min.css"
      rel="stylesheet"
    />
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>

  <body id="top">
    <main>
      <nav class="navbar navbar-expand-lg">
        <div class="container">
          <a class="navbar-brand" href="{{ url_for('index') }}">
            <i class="bi bi-person-lock"></i>
            <span>CryptoPlayground</span>
          </a>

          <div class="d-lg-none ms-auto me-4">
            <a href="#top" class="navbar-icon bi-person smoothscroll"></a>
          </div>

          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarNav"
            aria-controls="navbarNav"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>

          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-lg-5 me-lg-auto">
              <li class="nav-item">
                <a class="nav-link click-scroll" href="/">Inicio</a
                >
              </li>

              <li class="nav-item">
                <a class="nav-link click-scroll" href="/"
                  >Explorar cifrados</a
                >
              </li>

              <li class="nav-item">
                <a class="nav-link click-scroll" href="/ #section_3"
                  >Cómo funciona</a
                >
              </li>

              <li class="nav-item">
                <a class="nav-link click-scroll" href="{{ url_for('contact') }}">Nosotros</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>

        <header
          class="site-header d-flex flex-column justify-content-center align-items-center"
        >
          <div class="container">
            <div class="row justify-content-center align-items-center">
              <div class="col-lg-5 col-12 mb-5">
                <nav aria-label="breadcrumb">
                  <ol class="breadcrumb">
                    <li class="breadcrumb-item">
                      <a href="{{ url_for('index') }}">Inicio</a>

                    <li class="breadcrumb-item active" aria-current="page">
                      Cifrado RSA
                    </li>
                  </ol>
                </nav>

                <h2 class="text-white">Cifrado RSA<br /></h2>

                <div class="d-flex align-items-center mt-5">
                  <a
                    href="#playground"
                    class="btn custom-btn custom-border-btn smoothscroll me-4"
                    >Playground!</a
                  >
                </div>
              </div>

              <div class="col-lg-5 col-12">
                <div class="topics-detail-block bg-white shadow-lg">
                  <img
                    src="../static/images/topics/rsa.png"
                    class="topics-detail-block-image img-fluid"
                  />
                </div>
              </div>
            </div>
          </div>
        </header>

        

      <section class="topics-detail-section section-padding" id="biblio">
        <div class="container">
          <div class="row">
            <div class="col-lg-8 col-12 m-auto">
              <h3 class="mb-4">Cifrado RSA</h3>

              <p>
                El cifrado RSA es uno de los esquemas de criptografía de clave pública más importantes y ampliamente utilizados en la historia de la seguridad informática.
              </p>
              
              <p><strong>Contexto Histórico</strong></p>
              <p>
                RSA fue propuesto en 1977 por Ron Rivest, Adi Shamir y Leonard Adleman, de quienes toma su nombre. Antes de RSA, la criptografía se basaba mayormente en sistemas simétricos, en los cuales el mismo secreto se utilizaba tanto para cifrar como para descifrar. RSA introdujo la idea revolucionaria de la criptografía de clave pública, permitiendo distribuir abiertamente una clave para cifrar la información, mientras que una clave privada, mantenida en secreto, se usa para descifrarla. Este avance facilitó el intercambio seguro de datos en redes abiertas, como Internet, y sentó las bases para la infraestructura de clave pública (PKI).
              </p>
              
              <p><strong>Teoría Matemática detrás del Cifrado RSA</strong></p>
              <p>
                RSA se fundamenta en varios principios de la teoría de números:
              </p>
              <ul>
                <li>
                  <strong>Números Primos y Factorización:</strong>  
                  Se seleccionan dos números primos grandes, \( p \) y \( q \). Se define el módulo como:
                  <br>
                  \( n = p \times q \).
                  <br>
                  La seguridad de RSA se basa en la dificultad de factorizar \( n \) en sus factores primos.
                </li>
                <li>
                  <strong>Función Totiente de Euler:</strong>  
                  Se calcula:
                  <br>
                  \( \phi(n) = (p-1)(q-1) \),
                  <br>
                  que representa la cantidad de enteros menores que \( n \) que son coprimos con \( n \).
                </li>
                <li>
                  <strong>Selección del Exponente de Cifrado:</strong>  
                  Se elige un entero \( e \) tal que \( 1 < e < \phi(n) \) y que sea coprimo con \( \phi(n) \). Este valor \( e \) se utiliza como exponente público.
                </li>
                <li>
                  <strong>Cálculo del Exponente de Descifrado:</strong>  
                  Se determina \( d \) como el inverso modular de \( e \) respecto a \( \phi(n) \), es decir, se cumple que:
                  <br>
                  \( d \times e \equiv 1 \pmod{\phi(n)} \).
                  <br>
                  La pareja \( (n, e) \) constituye la <em>clave pública</em>, y \( d \) es la <em>clave privada</em>.
                </li>
                <li>
                  <strong>Proceso de Cifrado y Descifrado:</strong>  
                  Convertido el mensaje \( m \) a un número menor que \( n \), se cifra como:
                  <br>
                  \( c = m^e \mod n \),
                  <br>
                  y se descifra como:
                  <br>
                  \( m = c^d \mod n \).
                  <br>
                  Estas operaciones se realizan en aritmética modular.
                </li>
              </ul>
              
              <p><strong>Restricciones y Consideraciones de Seguridad</strong></p>
              <ul>
                <li>
                  <strong>Tamaño de la Clave:</strong>  
                  Es esencial utilizar un tamaño de clave lo suficientemente grande (por ejemplo, 2048 bits o más) para que la factorización de \( n \) sea inviable con la tecnología actual.
                </li>
                <li>
                  <strong>Relleno (Padding):</strong>  
                  La versión básica de RSA es vulnerable a ciertos ataques, por lo que se emplean esquemas de relleno como PKCS1 OAEP, que añaden aleatoriedad y aseguran una estructura adecuada al mensaje cifrado.
                </li>
                <li>
                  <strong>Conversión de Datos:</strong>  
                  Dado que RSA opera sobre números, es necesario convertir los mensajes a un formato numérico. En la práctica se utilizan codificaciones (como Base64) para transmitir datos binarios de forma segura en canales basados en texto (por ejemplo, en JSON).
                </li>
              </ul>
              
              <p><strong>Restricciones y valores definidos en la implementación</strong></p>
              <p>
                La implementación en Python establece ciertos parámetros y restricciones clave para garantizar la seguridad y correcto funcionamiento del cifrado RSA:
              </p>
              <ul>
                <li>
                  <strong>Tamaño de llave por defecto:</strong>  
                  Se utiliza un tamaño de llave por defecto de 2048 bits, configurable mediante el parámetro <code>key_size</code> en el endpoint <code>/generate-rsa-keys</code>.
                </li>
                <li>
                  <strong>Generación de la llave:</strong>  
                  La llave RSA se genera usando <code>RSA.generate(key_size)</code>. Posteriormente, la llave pública y la privada se exportan en formato DER, lo que estandariza su representación.
                </li>
                <li>
                  <strong>Codificación en Base64:</strong>  
                  Tanto la clave pública como la privada se codifican en Base64 para facilitar su transmisión en formato JSON, permitiendo su almacenamiento y distribución segura.
                </li>
                <li>
                  <strong>Proceso de cifrado:</strong>  
                  El endpoint <code>/process-rsa</code> recibe, en formato JSON, el mensaje a procesar, la acción deseada (cifrar o descifrar) y la llave correspondiente codificada en Base64. Para cifrar, se decodifica e importa la llave pública, se utiliza el esquema PKCS1 OAEP para aplicar un relleno seguro, y luego el mensaje se cifra; el resultado se vuelve a codificar en Base64 para su devolución.
                </li>
                <li>
                  <strong>Proceso de descifrado:</strong>  
                  Para descifrar, se decodifica e importa la llave privada, se descifra el mensaje (previamente decodificado de Base64) utilizando el mismo esquema de relleno, y finalmente el mensaje resultante se decodifica en UTF-8 para ser presentado en un formato legible.
                </li>
              </ul>
          
              
            </div>
          </div>
        </div>
      </section>

      <section class="section-padding section-bg" id="playground">
        <div class="container">
          <div class="row justify-content-center">
            <div class="col-lg-8 col-12">
              <div class="card shadow">
                <div class="card-body">
                  <form id="rsaForm">
                    <h3 class="card-title text-center mb-4">
                      Cifrado/Descifrado RSA
                    </h3>
      
                    <!-- Selector de acción -->
                    <div class="btn-group w-100 mb-4" role="group">
                      <input type="radio" class="btn-check" name="rsaAction" id="encryptRadio" value="encrypt" checked />
                      <label class="btn btn-outline-primary" for="encryptRadio">Cifrar</label>
                      <input type="radio" class="btn-check" name="rsaAction" id="decryptRadio" value="decrypt" />
                      <label class="btn btn-outline-primary" for="decryptRadio">Descifrar</label>
                    </div>
      
                    <!-- Campo de texto a procesar -->
                    <div class="mb-3">
                      <label class="form-label">Texto a procesar</label>
                      <textarea class="form-control" id="message" rows="4" required></textarea>
                    </div>
      
                    <!-- Generación de llaves -->
                    <div class="mb-4">
                      <div class="d-grid gap-2">
                        <button type="button" id="generateKeys" class="btn btn-secondary">
                          <i class="bi bi-key me-2"></i>Generar Nuevas Llaves
                        </button>
                      </div>
                      <div class="mt-3">
                        <select class="form-select" id="keySize">
                          <option value="1024">Llave de 1024 bits</option>
                          <option value="2048" selected>
                            Llave de 2048 bits
                          </option>
                          <option value="3072">Llave de 3072 bits</option>
                        </select>
                      </div>
                    </div>
      
                    <!-- Campos de llaves -->
                    <div class="mb-3">
                      <label class="form-label">Llave Pública (e, n)</label>
                      <input type="text" class="form-control" id="publicKey" required />
                    </div>
      
                    <div class="mb-4">
                      <label class="form-label">Llave Privada (d, n)</label>
                      <input type="text" class="form-control" id="privateKey" required />
                    </div>
      
                    <!-- Botón de procesamiento -->
                    <div class="d-grid">
                      <button type="submit" class="btn btn-primary btn-lg">
                        <i class="bi bi-gear me-2"></i>Procesar
                      </button>
                    </div>
      
                    <!-- Resultados -->
                    <div id="resultado" class="mt-4" style="display: none">
                      <h5 class="mb-3">Resultado:</h5>
                      <div id="resultText" class="alert alert-success alert-result"></div>
                      <button type="button" id="copyButton" class="btn btn-outline-secondary w-100">
                        <i class="bi bi-clipboard me-2"></i>Copiar Resultado
                      </button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    

    </main>

    <script src="../static/js/jquery.min.js"></script>
    <script src="../static/js/bootstrap.bundle.min.js"></script>
    <script src="../static/js/jquery.sticky.js"></script>
    <script src="../static/js/custom.js"></script>
  </body>
  
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const form = document.querySelector("form");
      const resultDiv = document.getElementById("resultado");
      const resultText = document.getElementById("resultText");
      const copyButton = document.getElementById("copyButton");

      // Generar llaves al cargar
      generateNewKeys();

      // Manejador de generación de llaves
      document
        .getElementById("generateKeys")
        .addEventListener("click", generateNewKeys);

      // Manejador de envío del formulario
      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const action = document.querySelector(
          'input[name="rsaAction"]:checked',
        ).value;
        const message = document.getElementById("message").value;
        const publicKey = document.getElementById("publicKey").value;
        const privateKey = document.getElementById("privateKey").value;

        try {
          const response = await fetch("/process-rsa", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({
              action,
              message,
              public_key: publicKey,
              private_key: privateKey,
            }),
          });

          const data = await response.json();

          if (!response.ok)
            throw new Error(data.error || "Error del servidor");

          resultText.textContent = data.result;
          resultDiv.style.display = "block";
          resultText.classList.remove("alert-danger");
          resultText.classList.add("alert-success");
        } catch (error) {
          resultText.textContent = `Error: ${error.message}`;
          resultDiv.style.display = "block";
          resultText.classList.remove("alert-success");
          resultText.classList.add("alert-danger");
          console.error("Error:", error);
        }
      });

      // Manejador de copiado
      copyButton.addEventListener("click", () => {
        navigator.clipboard
          .writeText(resultText.textContent)
          .then(() => alert("Texto copiado al portapapeles"))
          .catch((err) => console.error("Error al copiar:", err));
      });

      // Función para generar llaves
      async function generateNewKeys() {
        const keySize = parseInt(document.getElementById("keySize").value);

        try {
          const response = await fetch("/generate-rsa-keys", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({key_size: keySize}),
          });

          const data = await response.json();

          if (!response.ok)
            throw new Error(data.error || "Error generando llaves");

          document.getElementById("publicKey").value = data.public_key;
          document.getElementById("privateKey").value = data.private_key;
        } catch (error) {
          console.error("Error generando llaves:", error);
          alert("Error generando llaves: " + error.message);
        }
      }
    });
  </script>
  

</html>